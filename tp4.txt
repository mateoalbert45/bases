1.2
select * from departamento D
where NOT exists(
                                 select distinct d.id_departamento, e.id_empleado
                                 from departamento d1 join empleado e on (d1.id_departamento = e.id_departamento and d1.id_distribuidor = e.id_distribuidor)
                                 join tarea t on (e.id_tarea = t.id_tarea)
                                 where t.sueldo_maximo - t.sueldo_minimo < (select (t.sueldo_maximo/100)*30) and 
                                 d1.id_distribuidor = d.id_distribuidor and d1.id_departamento = d.id_departamento
                                 )
limit 1000
1.2 2
select *
from departamento d
where d.id_departamento not in(select e.id_departamento
from empleado e join tarea t on (e.id_tarea = t.id_tarea)
where (sueldo_maximo - sueldo_minimo) < 0.30 * sueldo_maximo)

1.3 
select count ( distnct p.codigo_pelicula) as "total de peliculas"
from pelicula p join renglon_entrega re on (p.codigo_pelicula= re.codigo_pelicula)
                join entrega e on (re.nro_entrega = e.nro_entrega)
                join distribuidor d on (e.id_distribuidor = d.id_distribuidor)
where extract(year from e.fecha_entrega) = 2006 and d.tipo = 'N'

1.4
select count( distinct  p.codigo_pelicula) as hola
from pelicula p join renglon_entrega re on (p.codigo_pelicula= re.codigo_pelicula)
                join entrega e on (re.nro_entrega = e.nro_entrega)
                join distribuidor d on (e.id_distribuidor = d.id_distribuidor)
where d.tipo != 'I'


1.4 bien hecho xd
select count( distinct  p.codigo_pelicula) as hola
from pelicula p join renglon_entrega re on (p.codigo_pelicula= re.codigo_pelicula)
                join entrega e on (re.nro_entrega = e.nro_entrega)
                join distribuidor d on (e.id_distribuidor = d.id_distribuidor)
where d.tipo = 'N'
and e.nro_entrega not in (select nro_entrega from entrega e join distribuidor d1 on (e.id_distribuidor = d1.id_distribuidor)
where d1.tipo = 'I')
limit 100

1.5 en departamento la clave primaria esta compuesta por dos columnas
select e.id_empleado
from empleado e join departamento d on (e.id_empleado = d.jefe_departamento)
                join ciudad c on (d.id_ciudad = c.id_ciudad)
                join pais p on (c.id_pais = p.id_pais)
where e.id_jefe is null and p.nombre_pais = 'ARGENTINA'

1.6
select e.id_empleado,e.apellido, e.nombre, e.id_departamento
from empleado e join departamento d on (e.id_departamento = d.id_departamento and e.id_distribuidor = d.id_distribuidor)
                join ciudad c on (d.id_ciudad = c.id_ciudad)
                join pais p on (c.id_pais = p.id_pais)
where  p.nombre_pais = 'ARGENTINA' and d.jefe_departamento IN(select  e.id_empleado 
                                         from departamento d  join empleado e on(e.id_empleado = d.jefe_departamento)
where e.porc_comision > 10
)

1.7 no hay peliculas en la base en los ultimos 5 aÃ±os xdd
select distinct p.codigo_pelicula, p.genero
from pelicula p join renglon_entrega re on (p.codigo_pelicula= re.codigo_pelicula)
                join entrega e on (re.nro_entrega = e.nro_entrega)
where extract(year from e.fecha_entrega) >= 2009 
order by p.genero

1.8
select re.nro_entrega, count(re.nro_entrega) as "cantidad de entregas", d.nombre ,e.fecha_entrega
from renglon_entrega re join entrega e on(re.nro_entrega = e.nro_entrega)
                        join distribuidor d on(e.id_distribuidor = d.id_distribuidor)  
group by re.nro_entrega,d.nombre,e.fecha_entrega
order by e.fecha_entrega
limit 1000

1.9
select c.nombre_ciudad, count(e.id_empleado) as "cantidad"
from ciudad c join departamento d on(c.id_ciudad = d.id_ciudad)
              join empleado e on(d.id_departamento = e.id_departamento and d.id_distribuidor = e.id_distribuidor)
group by c.nombre_ciudad HAVING count(e.id_empleado) > 30
order by cantidad
limit 1000

2.1
select distinct i.id_institucion, i.nombre_institucion, v.nro_voluntario, v.horas_aportadas
from institucion i join voluntario v on(i.id_institucion = v.id_institucion)
where v.horas_aportadas is not null
order by i.nombre_institucion
2.2
select count(v.id_coordinador) as "numero de coordinadores", c.nombre_continente, p.nombre_pais
from continente c join pais p on(c.id_continente = p.id_continente)
                  join direccion d on (p.id_pais = d.id_pais)
                  join institucion i on(d.id_direccion = i.id_direccion)
                  join voluntario v on (i.id_institucion = v.id_institucion)
group by c.nombre_continente, p.nombre_pais
2.3
select v.nombre, v.apellido, v.fecha_nacimiento, i.id_institucion
from voluntario v join institucion i on(v.id_institucion = i.id_institucion)
where i.id_institucion = 80 and v.apellido <> 'Zlotkey'
2.4
select nro_voluntario,apellido, horas_aportadas
from voluntario
where horas_aportadas > (select AVG(horas_aportadas) from voluntario)
order by horas_aportadas ASC

